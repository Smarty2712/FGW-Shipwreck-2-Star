from phBot import *
import QtBind,struct,os,json,signal
import threading
import time
import threading
from math import sqrt
from time import sleep


gui = QtBind.init(__name__,'Forgotten World')
btnShipwreck2 = QtBind.createButton(gui,'btnShipwreck2_clicked',"  Shipwreck 2*  ",348,100 )
btnStop = QtBind.createButton(gui,'btnStop_clicked', " Stop ", 348, 200)




	

def btnShipwreck2_clicked(): 
	threading.Thread(target=movements).start()
	log('Shipwreck 2* Started')
	#log('Region is %f' % (get_position()['region']))
	
def btnStop_clicked():
	raise SystemExit()
	
#not neccessary at the moment
#def checkMonsterAround():
#	
#	monster = True		
#	numberMonster = 0
#	counter = 0
#	
#	while monster == True:
#		numberMonster = len(get_monsters())
#		if numberMonster <= 1:
#			if counter == 5:
#				monster = False
#			else:
#				sleep(3.0)
#				counter += 1
#		
#		sleep(1.0)

def checkMonsterAround2():
	
	monster = True		
	numberMonster = 0
	counter = 0
	numberGhostCurse = 0
	
	while monster == True:
		listMonster = get_monsters()
		numberGhostCurse = 0
		for _id, m in listMonster.items():
			if m['name'] == 'Ghost Curse':
				numberGhostCurse += 1
		numberMonster = len(listMonster) - numberGhostCurse
		if numberMonster <= 0:
			if counter >= 5:
				return 0
			else:
				sleep(2.0)
				counter += 1
		sleep(1.0)	
		
def move(x, y, z):
	move_to(x, y, z)

	count = 0

	while sqrt((x - get_character_data()['x']) ** 2 + (y - get_character_data()['y']) ** 2) > 2:
		sleep(1.0)

		count += 1
		if count > 30:
			log('30 seconds have elapsed, giving up')
			raise SystemExit()
#	
#def move2(x, y):
#	threading.Thread(target=move args=(x, y, 0.0)).start()
	
def training(r, x, y):
	set_training_position(r, x, y)
	start_bot()
	checkMonsterAround2()
	stop_bot()
	
def movements():
	move(20761.0, 4396.0, -779.0)
	move(20786.0, 4374.0, -782.0)
	move(20796.0, 4365.0, -782.0)
	move(20827.0, 4319.0, -840.0)
	move(20842.0, 4293.0, -842.0)
	move(20832.0, 4269.0, -842.0)
	move(20809.0, 4251.0, -842.0)
	move(20802.0, 4244.0, -842.0)
	move(20802.0, 4193.0, -890.0)
	move(20802.0, 4168.0, -865.0)
	move(20804.0, 4154.0, -846.0)
	move(20810.0, 4143.0, -846.0)
	move(20804.0, 4107.0, -842.0)
	move(20802.0, 4099.0, -842.0)
	training(0, 20802.0, 4098.0)
	move(20802.0, 4099.0, -842.0)
	move(20856.0, 4116.0, -844.0)
	move(20877.0, 4132.0, -846.0)
	move(20923.0, 4168.0, -842.0)
	training(0, 20923.0, 4168.0)
	move(20923.0, 4168.0, -842.0)
	move(20895.0, 4144.0, -846.0)
	move(20864.0, 4119.0, -846.0)
	move(20834.0, 4099.0, -846.0)
	move(20810.0, 4083.0, -846.0)
	move(20820.0, 4060.0, -846.0)	#Run through wall
	move(20799.0, 3978.0, -931.0)
	move(20790.0, 3946.0, -945.0)
	move(20780.0, 3907.0, -951.0)
	move(20774.0, 3883.0, -921.0)
	move(20769.0, 3869.0, -910.0)	#run through wall
	move(20758.0, 3866.0, -910.0)
	move(20725.0, 3858.0, -906.0)
	move(20735.0, 3828.0, -906.0)
	move(20744.0, 3805.0, -906.0)
	training(0, 20744.0, 3805.0)
	move(20744.0, 3805.0, -906.0)
	move(20740.0, 3777.0, -910.0)
	move(20745.0, 3748.0, -910.0)
	move(20765.0, 3728.0, -907.0)
	move(20775.0, 3717.0, -906.0)
	training(0, 20775.0, 3717.0)
	move(20775.0, 3717.0, -906.0)
	move(20752.0, 3730.0, -910.0)
	move(20728.0, 3730.0, -910.0)
	move(20716.0, 3731.0, -912.0)
	move(20668.0, 3748.0, -942.0)
	move(20620.0, 3767.0, -886.0)
	move(20601.0, 3753.0, -887.0)
	move(20578.0, 3732.0, -887.0)
	move(20559.0, 3715.0, -885.0)
	move(20538.0, 3706.0, -884.0)
	move(20519.0, 3710.0, -876.0)
	move(20490.0, 3732.0, -876.0)
	training(0, 20490.0, 3732.0)
	move(20490.0, 3732.0, -876.0)
	move(20457.0, 3758.0, -876.0)
	move(20426.0, 3783.0, -876.0)
	move(20395.0, 3809.0, -876.0)
	move(20372.0, 3845.0, -884.0)
	move(20345.0, 3852.0, -876.0)
	training(0, 20345.0, 3852.0)
	move(20345.0, 3852.0, -876.0)
	move(20362.0, 3838.0, -876.0)
	move(20382.0, 3822.0, -876.0)
	move(20404.0, 3805.0, -876.0)
	move(20423.0, 3801.0, -881.0)
	training(0, 20423.0, 3801.0)
	move(20423.0, 3801.0, -881.0)
	move(20454.0, 3804.0, -885.0)
	training(0, 20454.0, 3804.0)
	move(20454.0, 3804.0, -885.0)
	move(20472.0, 3791.0, -884.0)
	move(20509.0, 3776.0, -887.0)
	move(20515.0, 3760.0, -884.0)
	move(20540.0, 3758.0, -887.0)
	move(20572.0, 3755.0, -887.0)
	move(20597.0, 3756.0, -887.0)
	move(20618.0, 3766.0, 0.0)
	move(20666.0, 3750.0, -941.0)	
	move(20705.0, 3734.0, -936.0)
	move(20721.0, 3729.0, -910.0)
	move(20748.0, 3743.0, -910.0)
	move(20765.0, 3734.0, -906.0)
	move(20789.0, 3726.0, -910.0)
	move(20815.0, 3725.0, -910.0)
	move(20825.0, 3725.0, 0.0)
	move(20830.0, 3727.0, 0.0)
	move(20863.0, 3706.0, -936.0)
	move(20886.0, 3695.0, -937.0)
	move(20893.0, 3674.0, -937.0)
	move(20898.0, 3643.0, -964.0)
	move(20899.0, 3608.0, -985.0)
	move(20902.0, 3568.0, -998.0)
	move(20905.0, 3515.0, -1002.0)
	move(20906.0, 3484.0, -992.0)
	move(20904.0, 3456.0, -989.0)
	move(20875.0, 3441.0, -985.0)
	training(0, 20875.0, 3441.0)
	move(20875.0, 3441.0, -985.0)
	move(20899.0, 3425.0, -987.0)
	move(20928.0, 3413.0, -987.0)
	move(20960.0, 3417.0, -987.0)
	move(20979.0, 3420.0, -985.0)
	training(0, 20979.0, 3420.0)
	move(20979.0, 3420.0, -985.0)
	move(20956.0, 3418.0, -987.0)
	move(20929.0, 3412.0, -989.0)
	move(20890.0, 3414.0, -989.0)
	move(20869.0, 3415.0, -989.0)
	move(20855.0, 3388.0, -992.0)
	move(20846.0, 3362.0, -987.0)
	move(20834.0, 3326.0, -969.0)
	move(20821.0, 3287.0, -939.0)
	move(20809.0, 3251.0, -903.0)
	move(20802.0, 3232.0, -866.0)
	move(20802.0, 3211.0, -846.0)
	move(20807.0, 3190.0, -846.0)
	move(20823.0, 3174.0, -842.0)
	training(0, 20823.0, 3174.0)
	move(20823.0, 3174.0, -842.0)
	move(20795.0, 3164.0, -842.0)
	move(20772.0, 3163.0, -844.0)
	move(20745.0, 3152.0, -846.0)
	move(20731.0, 3131.0, -846.0)
	move(20720.0, 3117.0, -842.0)
	move(20713.0, 3107.0, -842.0)
	training(0, 20713.0, 3107.0)
	move(20713.0, 3107.0, -842.0)
	move(20739.0, 3114.0, -846.0)
	move(20773.0, 3126.0, -846.0)
	move(20795.0, 3133.0, -846.0)
	move(20828.0, 3100.0, -870.0)
	move(20858.0, 3073.0, -896.0)
	move(20879.0, 3054.0, -904.0)
	move(20904.0, 3031.0, -906.0)
	move(20928.0, 3009.0, -907.0)
	move(20955.0, 2986.0, -904.0)
	move(20982.0, 2962.0, -895.0)
	move(20997.0, 2947.0, -887.0)
	move(21005.0, 2928.0, -885.0)
	move(21000.0, 2902.0, -887.0)
	move(20997.0, 2871.0, -887.0)
	move(21009.0, 2847.0, -887.0)
	move(21045.0, 2856.0, -887.0)
	move(21049.0, 2839.0, -876.0)
	move(21051.0, 2834.0, -876.0)
	training(0, 21051.0, 2834.0)
	move(21051.0, 2834.0, -876.0)
	move(21092.0, 2842.0, -876.0)
	move(21120.0, 2848.0, -876.0)
	move(21153.0, 2854.0, -876.0)
	move(21176.0, 2885.0, -885.0)
	training(0, 21176.0, 2885.0)
	move(21176.0, 2885.0, -885.0)
	move(21167.0, 2885.0, -885.0)
	move(21142.0, 2868.0, -887.0)
	move(21119.0, 2867.0, -887.0)
	training(0, 21119.0, 2867.0)
	move(21119.0, 2867.0, -887.0)
	move(21143.0, 2864.0, -884.0)
	move(21168.0, 2870.0, -887.0)
	move(21196.0, 2881.0, -887.0)
	move(21200.0, 2903.0, -887.0)
	move(21215.0, 2928.0, -884.0)
	move(21230.0, 2947.0, -887.0)
	move(21239.0, 2968.0, -885.0)
	move(21245.0, 2985.0, -891.0)
	move(21273.0, 3015.0, -902.0)
	move(21295.0, 3040.0, -906.0)
	move(21323.0, 3071.0, -906.0)
	move(21363.0, 3115.0, -903.0)
	move(21389.0, 3144.0, -902.0)
	move(21415.0, 3173.0, -888.0)
	move(21438.0, 3197.0, -862.0)
	move(21452.0, 3215.0, -846.0)
	move(21455.0, 3222.0, -846.0)
	move(21471.0, 3245.0, -842.0)
	move(21477.0, 3244.0, -842.0)
	training(0, 21477.0, 3244.0)
	move(21477.0, 3244.0, -842.0)
	move(21496.0, 3226.0, -846.0)
	move(21520.0, 3211.0, -842.0)
	move(21555.0, 3207.0, -842.0)
	move(21567.0, 3204.0, -842.0)
	training(0, 21567.0, 3203.0)
	move(21567.0, 3204.0, -842.0)
	move(21548.0, 3224.0, -846.0)
	move(21520.0, 3257.0, -846.0)
	move(21523.0, 3282.0, -847.0)
	move(21504.0, 3321.0, -877.0)
	move(21491.0, 3351.0, -901.0)
	move(21478.0, 3377.0, -918.0)
	move(21454.0, 3429.0, -947.0)
	move(21443.0, 3452.0, -956.0)
	move(21433.0, 3474.0, -959.0)
	move(21424.0, 3493.0, -953.0)
	move(21414.0, 3513.0, -945.0)
	move(21401.0, 3533.0, -944.0)
	move(21395.0, 3570.0, -940.0)
	training(0, 21395.0, 3570.0)
	move(21395.0, 3570.0, -940.0)
	move(21363.0, 3559.0, -942.0)
	move(21343.0, 3541.0, -944.0)
	move(21311.0, 3500.0, -940.0)
	training(0, 21311.0, 3500.0)
	move(21311.0, 3500.0, -940.0)
	move(21334.0, 3530.0, -944.0)
	move(21353.0, 3555.0, -942.0)
	move(21391.0, 3596.0, -944.0)
	move(21380.0, 3620.0, -944.0)
	move(21358.0, 3663.0, -901.0)
	move(21350.0, 3686.0, -901.0)
	move(21354.0, 3701.0, -901.0)
	move(21389.0, 3748.0, -900.0)
	move(21411.0, 3779.0, -881.0)
	move(21423.0, 3795.0, -848.0)
	move(21431.0, 3806.0, -846.0)
	move(21461.0, 3809.0, -846.0)
	move(21470.0, 3853.0, -842.0)
	training(0, 21470.0, 3853.0)
	move(21470.0, 3853.0, -842.0)
	move(21475.0, 3884.0, -843.0)
	move(21475.0, 3930.0, -846.0)
	move(21461.0, 3952.0, -842.0)
	move(21453.0, 3957.0, -841.0)
	training(0, 21453.0, 3957.0)
	move(21453.0, 3957.0, -841.0)
	move(21421.0, 3959.0, -846.0)
	move(21406.0, 3959.0, -847.0)
	move(21370.0, 3975.0, -906.0)
	move(21321.0, 3997.0, -951.0)
	move(21293.0, 4039.0, -979.0)
	move(21275.0, 4076.0, -1001.0)
	move(21262.0, 4099.0, -996.0)
	move(21282.0, 4133.0, -994.0)
	move(21270.0, 4170.0, -994.0)
	training(0, 21270.0, 4170.0)
	move(21270.0, 4170.0, -994.0)
	move(21246.0, 4187.0, -994.0)
	move(21219.0, 4210.0, -991.0)
	move(21189.0, 4221.0, -992.0)
	move(21169.0, 4228.0, -991.0)
	training(0, 21169.0, 4228.0)
	move(21169.0, 4228.0, -991.0)
	move(21195.0, 4228.0, -994.0)
	move(21214.0, 4243.0, -994.0)
	move(21238.0, 4257.0, -997.0)
	move(21288.0, 4283.0, -971.0)
	move(21322.0, 4300.0, -935.0)
	move(21362.0, 4319.0, -880.0)
	move(21381.0, 4329.0, -847.0)
	move(21417.0, 4344.0, -846.0)
	move(21427.0, 4347.0, -842.0)
	training(0, 21427.0, 4347.0)
	move(21427.0, 4347.0, -842.0)
	move(21460.0, 4329.0, -846.0)
	move(21481.0, 4302.0, -846.0)
	move(21483.0, 4284.0, -842.0)
	move(21480.0, 4268.0, -842.0)
	training(0, 21480.0, 4268.0)
	move(21480.0, 4268.0, -842.0)
	move(21500.0, 4235.0, 0.0)
	move(21496.0, 4219.0, 0.0)
	move(21470.0, 4200.0, -846.0)
	move(21474.0, 4159.0, -885.0)
	move(21476.0, 4129.0, -887.0)
	move(21476.0, 4122.0, 0.0)
	move(21491.0, 4117.0, -889.0)
	move(21550.0, 4091.0, -930.0)
	move(21591.0, 4075.0, -948.0)
	move(21626.0, 4061.0, -956.0)
	move(21653.0, 4051.0, -944.0)
	move(21681.0, 4041.0, -934.0)
	move(21725.0, 4033.0, -934.0)
	move(21753.0, 4027.0, -934.0)
	move(21771.0, 4019.0, -934.0)
	move(21794.0, 4002.0, -969.0)
	move(21816.0, 3983.0, -990.0)
	move(21838.0, 3962.0, -989.0)
	move(21860.0, 3932.0, -989.0)
	move(21865.0, 3905.0, -989.0)
	move(21856.0, 3888.0, -989.0)
	training(0, 21856.0, 3888.0)
	move(21856.0, 3888.0, -989.0)
	move(21841.0, 3866.0, -988.0)
	move(21823.0, 3834.0, -979.0)
	move(21799.0, 3803.0, -985.0)
	move(21760.0, 3790.0, -989.0)
	move(21746.0, 3787.0, -992.0)
	move(21755.0, 3787.0, -992.0)
	training(0, 21755.0, 3787.0)
	move(21755.0, 3787.0, -992.0)
	move(21767.0, 3763.0, -991.0)
	training(0, 21767.0, 3763.0)
	move(21767.0, 3763.0, -991.0)
	move(21789.0, 3785.0, -979.0)
	move(21809.0, 3812.0, -981.0)
	move(21818.0, 3822.0, -981.0)
	training(0, 21818.0, 3822.0)
	move(21818.0, 3822.0, -981.0)
	move(21802.0, 3844.0, -990.0)
	training(0, 21801.0, 3844.0)
	
		

